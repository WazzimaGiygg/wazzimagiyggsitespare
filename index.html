
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carregando...</title>
<link rel="icon" href="favicom.png" type="image/x-icon">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.min.css">
<style id="custom-app-css">
/* Este será o local onde o CSS dos aplicativos do usuário será injetado */
</style>
<style id="custom-theme-color">
/* A cor do tema será injetada aqui pelo JavaScript */
</style>
<style>
/* Seus estilos CSS existentes aqui */
body {
display: flex;
flex-direction: column;
min-height: 100vh;
margin: 0;
font-family: 'Roboto', sans-serif;
background-color: #f5f5f5;
}
.mdl-layout__content {
flex-grow: 1;
display: flex;
position: relative; /* Adicionado para posicionamento absoluto */
padding: 0;
}
.page-content {
flex-grow: 1;
display: flex;
flex-direction: column;
}
.mdl-layout__drawer .mdl-navigation .mdl-navigation__link {
color: #424242;
}
.mdl-layout__drawer .mdl-navigation .mdl-navigation__link[data-requires-auth="true"] {
color: #9e9e9e;
pointer-events: none;
}
/* Estilo para o novo iframe de conteúdo em tela cheia */
#main-content-frame {
flex-grow: 1;
border: none;
width: 100%;
height: 100%;
position: absolute;
top: 0;
left: 0;
z-index: 0; /* z-index para ficar no fundo */
}
/* Estilo para o contêiner das janelas flutuantes */
#window-container {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 1000; /* Garante que as janelas fiquem por cima */
pointer-events: none; /* Permite cliques passarem para o iframe de fundo */
}
#window-container > .floating-window {
pointer-events: auto; /* Reativa os cliques para as janelas */
}
/* Estilo para as janelas flutuantes */
.floating-window {
display: flex;
flex-direction: column;
position: absolute;
min-width: 300px;
min-height: 200px;
background-color: white;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
border-radius: 8px;
overflow: hidden;
resize: both;
transition: transform 0.2s ease-out;
border: 1px solid #ccc;
top: 50px;
left: 50px;
z-index: 1000;
}
.window-header {
cursor: grab;
padding: 8px 12px;
background-color: #f5f5f5;
border-bottom: 1px solid #ddd;
display: flex;
align-items: center;
justify-content: space-between;
}
.window-header:active {
cursor: grabbing;
}
.window-header span {
font-weight: bold;
}
.window-controls button {
border: none;
background: none;
font-size: 24px;
cursor: pointer;
color: #666;
line-height: 1;
padding: 0 8px;
}
.window-controls button:hover {
color: #333;
}
.window-body {
flex-grow: 1;
overflow: hidden;
}
.window-body iframe {
width: 100%;
height: 100%;
border: none;
}
.mdl-layout__header-row {
padding: 0 16px;
}
.mdl-layout__header-row .mdl-navigation {
display: flex;
align-items: center;
}
.mdl-layout__header-row .mdl-navigation .mdl-navigation__link {
padding: 0 12px;
}
/* Estilo para a imagem de perfil */
#user-profile-pic {
width: 32px;
height: 32px;
border-radius: 50%;
margin-left: 8px;
vertical-align: middle;
display: none;
}
/* Estilos para o popup de apps */
#google-apps-button {
display: none;
}
#google-apps-popup {
display: none;
position: absolute;
top: 48px; /* Altura do header */
right: 0;
width: 300px;
background-color: white;
border-radius: 8px;
box-shadow: 0 5px 15px rgba(0,0,0,0.3);
z-index: 1000;
padding: 10px;
box-sizing: border-box;
}
#google-apps-popup h4 {
margin-top: 0;
margin-bottom: 10px;
color: #3f51b5;
text-align: center;
}
#app-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 10px;
padding: 10px;
}
.app-item {
display: flex;
flex-direction: column;
align-items: center;
text-align: center;
cursor: pointer;
padding: 8px;
border-radius: 4px;
transition: background-color 0.3s;
}
.app-item:hover {
background-color: #f0f0f0;
}
.app-item img {
width: 48px;
height: 48px;
margin-bottom: 5px;
}
.app-item span {
font-size: 0.8em;
color: #555;
}
/* Mensagens de acesso */
#access-denied-message, #banned-message {
display: none;
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
background-color: #ffe0b2;
border: 1px solid #ffb74d;
padding: 20px;
border-radius: 8px;
box-shadow: 0 4px 8px rgba(0,0,0,0.2);
text-align: center;
color: #e65100;
font-weight: bold;
z-index: 1001;
}
/* --- ESTILOS PARA NOTÍCIAS (Botão e Popup) --- */
#news-button {
margin-right: 8px;
display: none;
}
#news-center-popup {
display: none;
position: absolute;
top: 48px;
right: 0;
width: 400px;
max-height: 80vh;
background-color: white;
border-radius: 8px;
box-shadow: 0 5px 15px rgba(0,0,0,0.3);
z-index: 998;
flex-direction: column;
overflow: hidden;
}
#news-popup-header {
background-color: #3f51b5;
color: white;
padding: 10px 15px;
border-top-left-radius: 8px;
border-top-right-radius: 8px;
display: flex;
align-items: center;
justify-content: space-between;
font-weight: bold;
font-size: 16px;
}
#news-popup-header .close-button {
background: none;
border: none;
color: white;
font-size: 24px;
cursor: pointer;
padding: 0;
}
#news-popup-content {
flex-grow: 1;
overflow-y: auto;
padding: 15px;
}
#news-popup-footer {
padding: 10px 15px;
border-top: 1px solid #eee;
text-align: center;
}
#news-popup-footer button {
width: 100%;
}
/* Estilos para os itens de notícia dentro do popup (adaptados do seu código original) */
.news-popup-item {
background-color: #f9f9f9;
border: 1px solid #e0e0e0;
border-radius: 4px;
padding: 15px;
margin-bottom: 15px;
box-shadow: 0 1px 1px 0 rgba(0,0,0,.08);
}
.news-popup-item h3 {
margin-top: 0;
color: #5c6bc0;
}
.news-popup-item p {
color: #555;
line-height: 1.5;
}
.news-popup-item small {
font-size: 0.8em;
color: #888;
display: block;
margin-top: 10px;
}
.news-popup-item img {
max-width: 100%;
height: auto;
margin-top: 10px;
border-radius: 4px;
}
</style>
<script>
// Script de redirecionamento para navegadores não-Chromium
(function() {
const userAgent = navigator.userAgent;
const isChromium = !!window.chrome && userAgent.indexOf('Chrome') > -1 && userAgent.indexOf('Edg') === -1 && userAgent.indexOf('OPR') === -1;

if (!isChromium) {
window.location.href = './notchromium';
}
})();

// Script de redirecionamento para mobile
(function() {
const isMobile = /Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || (window.innerWidth <= 768);
if (isMobile) {
window.location.href = './mobile/index.html';
}
})();
</script>
</head>
<body>

<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
<header class="mdl-layout__header">
<div class="mdl-layout__header-row">
<span class="mdl-layout-title" id="wiki-page-name">Carregando...</span>
<a href="https://wikizero.wzzm.org/" id="./wikinotpedia/">
<img src="https://wzzm.org/wnp.png" alt="Logo Wiki Zone Zero Mod" style="height: 32px; vertical-align: middle; margin-right: 8px;"></a> <div class="mdl-layout-spacer"></div>
<nav class="mdl-navigation">
<button class="mdl-button mdl-js-button mdl-button--icon" id="error-log-button" title="Ver Erros">
<i class="material-icons">bug_report</i>
</button>
<a class="mdl-navigation__link" href="#" id="search-articles-link" onclick="createFloatingWindow('ferramentasuteis.html', null, false)">Procurar Artigos</a>
<div style="position: relative; display: flex; align-items: center;">
<button class="mdl-button mdl-js-button mdl-button--icon" id="news-button" style="display: none;">
<i class="material-icons">article</i>
</button>
<div id="news-center-popup">
<div id="news-popup-header">
<span>Últimas Notícias</span>
<button class="close-button" id="close-news-popup-button">×</button>
</div>
<div id="news-popup-content">
<p>Carregando últimas notícias...</p>
</div>
<div id="news-popup-footer">
<button id="view-all-news-button" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">
Ver todas as Notícias
</button>
</div>
</div>
<button class="mdl-button mdl-js-button mdl-button--icon" id="google-apps-button" style="display: none;">
<i class="material-icons">widgets</i>
</button>
<div id="google-apps-popup">
<h4>Serviços WZZM</h4>
<div id="app-grid">
</div>
</div>
<div id="user-info-container" style="display: none; align-items: center;">
<span id="user-info" style="margin-left: 8px; color: white;"></span>
<img id="user-profile-pic" src="" alt="Profile Pic">
<button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="logout-button" style="margin-left: 10px; display: none;">Sair</button>
</div>
<button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="login-google">Login Google</button>
<button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="login-github" style="margin-left: 10px;">Login GitHub</button>
</div>
</nav>
</div>
</header>
<div class="mdl-layout__drawer">
<span class="mdl-layout-title" id="drawer-title">Navegação</span>
<nav class="mdl-navigation" id="drawer-menu">
</nav>
</div>
<main class="mdl-layout__content">
<iframe id="main-content-frame" src="wnpx.html" frameborder="0"></iframe>
<div id="window-container"></div>
</main>
<div id="access-denied-message" style="display:none;">
<p>Acesso negado. Por favor, faça login para ver este conteúdo.</p>
</div>
<div id="banned-message" style="display:none;">
<p>Sua conta foi banida. Você não pode acessar o conteúdo.</p>
<p>Para mais informações, contate o suporte.</p>
</div>
<div id="error-log-popup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; max-width: 600px; height: 80%; max-height: 400px; background: white; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); z-index: 1002; flex-direction: column;">
<div style="padding: 16px; background-color: #f5f5f5; border-bottom: 1px solid #ccc; display: flex; justify-content: space-between; align-items: center;">
<h4 style="margin: 0;">Log de Erros do Console</h4>
<button onclick="document.getElementById('error-log-popup').style.display='none';" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
</div>
<ul id="error-log-list" style="list-style-type: none; margin: 0; padding: 16px; flex-grow: 1; overflow-y: auto;">
</ul>
</div>
</div>

<script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-analytics-compat.js"></script>
<script>


document.addEventListener('DOMContentLoaded', function() {

    // --- Configuração do Firebase ---
    const firebaseConfig = {
        apiKey: "AIzaSyB9GkSqTIZ0kbVsba_WOdQvAET-rF9qna0",
        authDomain: "wzzm-ce3fc.firebaseapp.com",
        projectId: "wzzm-ce3fc",
        storageBucket: "wzzm-ce3fc.appspot.com",
        messagingSenderId: "249427877153",
        appId: "1:249427877153:web:0e4297294794a5aadeb260",
        measurementId: "G-PLKNZNFCQ8"
    };

    // Acessa o objeto global 'firebase'
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    // --- Elementos do DOM ---
    const loginButton = document.getElementById('login-button');
    const logoutButton = document.getElementById('logout-button');
    const authStatus = document.getElementById('auth-status');
    const mainDashboard = document.getElementById('main-dashboard');
    const userDisplay = document.getElementById('user-display');
    const articleList = document.getElementById('article-list');
    const articleDetails = document.getElementById('article-details');
    const navLinks = document.querySelectorAll('.nav-link');
    const contentSections = document.querySelectorAll('.content-section');
    
    // Variáveis para armazenar o ID do artigo selecionado
    let selectedArticleId = null;

    // --- Funções de Navegação ---
    function showSection(sectionId) {
        contentSections.forEach(section => {
            section.style.display = 'none';
        });
        document.getElementById(sectionId).style.display = 'block';
    }

    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const sectionId = e.target.dataset.section;
            showSection(`section-${sectionId}`);
            
            if (sectionId === 'all-articles') {
                loadArticles();
                articleDetails.style.display = 'none';
                articleList.style.display = 'block';
            }
        });
    });

    // --- Funções de Login e Logout ---
    loginButton.addEventListener('click', () => {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider).catch(error => {
            console.error("Erro no login:", error);
            alert("Ocorreu um erro ao fazer login. Tente novamente.");
        });
    });

    logoutButton.addEventListener('click', () => {
        auth.signOut();
    });
    
    // --- Monitora o estado da autenticação ---
    auth.onAuthStateChanged(user => {
        if (user) {
            authStatus.style.display = 'none';
            mainDashboard.style.display = 'flex';
            userDisplay.textContent = user.displayName;
            loadArticles();
        } else {
            authStatus.style.display = 'block';
            mainDashboard.style.display = 'none';
        }
    });

    // --- Função para carregar as postagens ---
    async function loadArticles() {
        articleList.innerHTML = 'Carregando artigos...';
        try {
            const snapshot = await db.collection('wazzimagiyggfemboyverse69').orderBy('date', 'desc').get();
            articleList.innerHTML = '';
            
            if (snapshot.empty) {
                articleList.innerHTML = '<p>Nenhum artigo encontrado.</p>';
                return;
            }

            snapshot.forEach(doc => {
                const article = doc.data();
                const articleElement = document.createElement('div');
                articleElement.className = 'article-card';
                articleElement.dataset.id = doc.id;
                
                const date = article.date ? article.date.toDate().toLocaleDateString('pt-BR') : 'Data não disponível';
                
                articleElement.innerHTML = `
                    <h3>${article.title}</h3>
                    <p>Publicado em: ${date}</p>
                    <button class="view-button">Ver Conteúdo</button>
                `;
                
                articleList.appendChild(articleElement);
            });

            // Adiciona evento de clique para cada botão "Ver Conteúdo"
            document.querySelectorAll('.view-button').forEach(button => {
                button.addEventListener('click', (e) => {
                    const articleId = e.target.closest('.article-card').dataset.id;
                    viewArticleDetails(articleId);
                });
            });

        } catch (error) {
            console.error("Erro ao carregar artigos: ", error);
            articleList.innerHTML = '<p>Ocorreu um erro ao carregar os artigos.</p>';
        }
    }

    // --- Função para visualizar os detalhes de um artigo ---
    async function viewArticleDetails(articleId) {
        articleDetails.innerHTML = 'Carregando detalhes...';
        articleDetails.style.display = 'block';
        articleList.style.display = 'none';

        try {
            const doc = await db.collection('wazzimagiyggfemboyverse69').doc(articleId).get();

            if (!doc.exists) {
                articleDetails.innerHTML = '<p>Artigo não encontrado.</p>';
                return;
            }

            const article = doc.data();
            const date = article.date ? article.date.toDate().toLocaleDateString('pt-BR', { year: 'numeric', month: 'long', day: 'numeric' }) : 'Data não disponível';
            
            articleDetails.innerHTML = `
                <h2>${article.title}</h2>
                <p><strong>Data:</strong> ${date}</p>
                <div class="article-content">${article.content}</div>
                <button id="back-to-list-button">Voltar à Lista</button>
            `;

            // Adiciona evento ao botão de voltar
            document.getElementById('back-to-list-button').addEventListener('click', () => {
                articleDetails.style.display = 'none';
                articleList.style.display = 'block';
            });

        } catch (error) {
            console.error("Erro ao carregar detalhes do artigo: ", error);
            articleDetails.innerHTML = '<p>Ocorreu um erro ao carregar os detalhes.</p>';
        }
    }
    
    const contentSubmitForm = document.getElementById('content-submit-form');
    if (contentSubmitForm) {
        contentSubmitForm.addEventListener('submit', (e) => {
            e.preventDefault();
        });
    }
});
</script>
</body>
</html>
